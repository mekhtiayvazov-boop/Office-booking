<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Office Booking</title>
  <style>
    .seat { display:inline-block; width:60px; height:60px; margin:5px; text-align:center; line-height:60px; cursor:pointer; border-radius:5px; color:white; }
    .free { background-color: green; }
    .busy { background-color: red; }
  </style>
</head>
<body>
  <h1>Бронирование мест</h1>

  <label>Дата: <input type="date" id="date"></label>
  <div id="seats"></div>

  <script>
    const seats = ["4D26","4D27","4D28","4D31","4D32","4D33","4D34","4E29","4E30","4E32","4E33","4E34","4EX1","4EX2","4EX3"];
    const seatsDiv = document.getElementById("seats");
    const dateInput = document.getElementById("date");

    async function load() {
      const date = dateInput.value;
      const res = await fetch("/api/bookings");
      const data = await res.json();

      seatsDiv.innerHTML = "";
      seats.forEach(seat => {
        const booked = data.find(b => b.seat === seat && b.date === date);
        const div = document.createElement("div");
        div.className = `seat ${booked ? 'busy' : 'free'}`;
        div.textContent = seat;
        div.onclick = () => {
          if(booked) alert(`${booked.employee} забронировал это место`);
          else alert("Место свободно");
        };
        seatsDiv.appendChild(div);
      });
    }

    dateInput.addEventListener("change", load);
    window.addEventListener("load", () => {
      const today = new Date().toISOString().split("T")[0];
      dateInput.value = today;
      load();
    });
  </script>
</body>
</html>
